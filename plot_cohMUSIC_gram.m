function plot_cohMUSIC_gram(Pn,Ts,nblock,lenblock,ncov)% Filename:         plot_MUSIC_gram.m% Author:           D.R.Ohm   % Software:         Matlab R2020b% Rev.Date:         Sept.26,2005; Mar.1,2021%% Pn        a two-dimensional array of Bearing from "Array_MUSIC_coh.m" %           arranged by columns of time bins vs rows of bearing values % Ts        the sampling period in seconds (s),% angle_step    the angle step size used to compute the beamformer% nblock        number of data blocks used% lenblock      the stationary block size used%%==========================================================================[n_rows,n_cols] = size(Pn);gram = Pn';for r = 1:n_cols    linear_gram(r,:) = gram(r,:)./max(gram(r,:));endselection = input('Enter 0 for gray scale, 1 for color scale: ');figure('PaperOrientation','portrait',...              'PaperPosition',[1.1,1,6.5,9],...              'Position',[10,10,820,620],...              'Units','pixel');   %bmax = 360;                      % max bearing in degreesaxwidth = .78;b_axis = (0:n_rows);bmax = b_axis(end);t_axis = (0:n_cols)*nblock/ncov*lenblock*Ts;%*(Tm-ovlpb);tmax = t_axis(end);                      % max time in seconds (or time_unit used)  axes('Position',[.11,.97,axwidth,1],...                'Units','normalized',...                'Visible','off');text('Position',[.5,0],...                  'Units','normalized',...                  'FontSize',[16],...                  'HorizontalAlignment','center',...                  'VerticalAlignment','bottom',...                  'String','Coherent MUSIC Beamforming: BEARING - VS - TIME');              % Time-vs-bearing gram plotaxbottom = .15;axheight = .79; ax1 = axes('Position',[.11,axbottom,axwidth,axheight],...           'Units','normalized',...           'FontSize',[14],...           'Box','on',...           'TickDir','out',...           'NextPlot','add',...           'XGrid','off',...           'XLim',[0,bmax],...           'YLim',[0,tmax]);if selection == 0    colormap(gray(256));else    map = hsv(329);    colormap(map(256:-1:1,:));endset(ax1,'FontSize',[10])xlabel('Bearing (degrees)')ylabel('Center Time of Analysis Window (sec)')imagesc(b_axis,t_axis,linear_gram)colormap jet