function plot_CFB_gram_2(btr_energy,Ts,angle_step,seg_size,overlap,dB_range,titletext)% BTR --      a two-dimensional array of Energy values from a "Array_BTR.m" script, arranged by columns%                   of time bins vs rows of bearing values; % Fs       --       the sampling rate in samples per second (Hz), or samples per%                   time unit if other than seconds% seg_size% overlap       the overlap between analysis center times, in number of%                   samples (use same value as entered in the         % dB_range --       plot range in dB% titletext --      title of gram plot entered between quotes, such as 'Results for XXXX Data'%btr_energy = flipud(btr_energy');%imagesc(btr_energy)[n_rows,n_cols]=size(btr_energy);for r = 1:n_rows    linear_btr(r,:) = btr_energy(r,:)./max(btr_energy(r,:));endlinear_gram = linear_btr;log_gram = linear_gram;% log_gram = 10*log10(btr_energy(1:end,1:end)); % log_gram = log_gram - max(max(log_gram));% vec = find(log_gram < (-dB_range));% log_gram(vec) = -dB_range*ones(size(vec));fig1 = figure('PaperOrientation','portrait',...              'PaperPosition',[1.1,1,6.5,9],...              'Position',[10,10,820,620],...              'Units','pixel');   shift = seg_size - overlap;bmax=360;                      % max frequency in Hz (or cycles/time_unit used)tmax = 50;                      % max time in seconds (or time_unit used)axwidth = .78;b_axis = (0:n_cols)*angle_step;t_axis = (0:n_rows)*(Ts*shift);  ax_title = axes('Position',[.2,.97,axwidth,1],...                'Units','normalized',...                'Visible','off');            title_text = text('Position',[.5,0],...                  'Units','normalized',...                  'FontSize',[14],...                  'HorizontalAlignment','center',...                  'VerticalAlignment','bottom',...                  'String','Energy Normalized Bearing Vs. Time Gram');              % Time-vs-frequency gram plotaxbottom = .15;axheight = .79;%XX = [0;10;20;30;40;50;60;70];%YY = [0;.4;.8;1.2;1.6;2.0;2.4;2.8]; %ax1 = axes('Position',[.2,axbottom,axwidth,axheight],...ax1 = axes('Position',[.2,axbottom,axwidth,axheight],...           'Units','normalized',...           'FontSize',[12],...           'Box','on',...           'TickDir','out',...           'NextPlot','add',...           'XGrid','off',...           'XLim',[0,bmax],...           'YLim',[0,tmax]);%           'XTick',XX,...%           'YTick',YY);% selection = input('Enter 0 for gray scale, 1 for color scale: ');selection=1;if selection == 0    colormap(gray(256));else    map = hsv(329);    colormap(map(256:-1:1,:));endtitle(titletext)set(ax1,'FontSize',[9])xlabel('Bearing (degrees)')ylabel('Center Freq. of Analysis Window  (Freq)')imagesc(b_axis,t_axis,log_gram)% Color bar legend on left bottomax5 = axes('Position',[.15,.03,.02,.10],...           'Units','normalized',...           'Box','on',...           'NextPlot','add',...           'FontSize',[9],...           'TickDir','out',...           'XTickLabelMode','manual',...           'XTickLabel',[],...           'XLim',[1,2],...           'YLim',[-dB_range,0]);vec = (-dB_range:0)';barr = [vec vec];imagesc((1:2),(-dB_range:0),barr)ylabel('dB colormap')%