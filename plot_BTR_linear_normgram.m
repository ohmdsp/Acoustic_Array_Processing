function plot_BTR_linear_normgram(btr_energy,Ts,angle_step,seg_size,overlap,offset)%% btr       a two-dimensional array of Energy values from a Array_BTR.m %           script, arranged by time bins vs bearing values % Fs        Sampling rate in samples per second (Hz)% seg_size% overlap   the overlap between analysis center times, in number of%           samples (use same value as entered in the% offset    angle in radians used to offset start of bearning calulations%           (need to offset plot) %==========================================================================%-Compute magnitude and log for gramsgram = btr_energy;[n_rows,n_cols]=size(gram);gps_aval = input('Is GPS data available? (1-Yes, 0-No) ');if gps_aval==1    disp('Select GPS data file (.mat) ');    filename = uigetfile('*.mat','Select data to load');    %pathplusfile = [pathname filename];    load(filename)    target = input('How many targets have GPS data? ');end    linear_gram = zeros(n_rows,n_cols);for c = 1:n_cols    linear_gram(:,c) = btr_energy(:,c)./max(btr_energy(:,c));endselection = input('Enter 0 for gray scale, 1 for color scale: ');%-Plot Titlefigure('PaperOrientation','portrait',...              'PaperPosition',[1.1,1,6.5,9],...              'Position',[500,500,820,620],...              'Units','pixel');   shift = seg_size - overlap;%offset_deg = offset*180/pi;b_axis = (0:1:n_rows)*angle_step*180/pi - 180 + offset;   % note convert to degreesbmax = b_axis(end);bmin = b_axis(1);max_delay = 40;  % used in main routine and must be accounted for heret_axis = (0:n_cols)*shift*Ts + max_delay*Ts;tmax = t_axis(end);             % max time in seconds (or time_unit used)axwidth = .82;axes('Position',[.1,.96,axwidth,1],...                'Units','normalized',...                'Visible','off');            text('Position',[.5,0],...                  'Units','normalized',...                  'FontSize',[14],...                  'HorizontalAlignment','center',...                  'VerticalAlignment','bottom',...                  'String','NORMALIZED LINEAR BEARING - VS - TIME GRAM');              % Time-vs-frequency gram plotaxbottom = .15;axheight = .79;axes('Position',[.1,axbottom,axwidth,axheight],...           'Units','normalized',...           'FontSize',14,...           'Box','on',...           'TickDir','out',...           'NextPlot','add',...           'XGrid','off',...           'XLim',[0,tmax],...           'YLim',[bmin,bmax]);if selection == 0    colormap(gray(256));else    map = hsv(329);    colormap(map(256:-1:1,:));endylabel('Bearing (degrees)')xlabel('Center Time of Analysis Window  (sec)')imagesc(t_axis,b_axis,linear_gram)if gps_aval == 1    hold on    plot(t11,doa11,'*b','LineWidth', 1.0)    if target==2            plot(t21,doa21,'*k','LineWidth', 1.0);    end    hold off    legend('gps target 1', 'gps target 2')end%-Color bar legend on left bottomaxes('Position',[.04,.07,.10,.03],...           'Units','normalized',...           'Box','on',...           'NextPlot','add',...           'FontSize',[9],...           'YLim',[1,2],...           'TickDir','out',...           'YTickLabelMode','manual',...           'YTickLabel',[],...           'XLim',[0,1]);vec = (0:.1:1)';barr = [vec vec]';imagesc((0:.1:1),(1:.1:2),barr)xlabel('colormap')