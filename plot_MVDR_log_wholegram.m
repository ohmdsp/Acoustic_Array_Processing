function plot_MVDR_log_wholegram(mvdr_energy,Fs,angle_step,seg_size)%% mvdr          a two-dimensional array of Energy values from a %               Array_CBF.m script, arranged by columns of time bins vs %               rows of bearing values % Fs            Sampling rate in samples per second (Hz)% seg_size% overlap       The overlap between analysis center times, in number of%               samples (use same value as entered in the         %==========================================================================  %-Compute magnitude and log for tf gramsep = 1.0e-16;gram = abs(mvdr_energy);[n_rows,n_cols]=size(gram);%-Compute magnitude and log ranges for gram plotsmax_gram        = max(max((gram)));log_gram        = 10*log10((gram)/max_gram + ep);dB_top          = input('Enter top range in dB (example: 0): ');dB_bottom       = input('Enter bottom range in dB (example: 65): ');vec             = find(log_gram < (-dB_bottom));log_gram(vec)   = -dB_bottom*ones(size(vec));vec             = find(log_gram > (-dB_top));log_gram(vec)   = -dB_top*ones(size(vec));selection = input('Enter 0 for gray scale, 1 for color scale: ');%-Configure Plotfigure('PaperOrientation','portrait',...              'PaperPosition',[1.1,1,6.5,9],...              'Position',[10,10,820,620],...              'Units','pixel');   bmax = 360;                     % max bearing in degreesfmax = Fs/2;                    % max frequency in Hzaxwidth = .78;b_axis = (0:n_cols)*angle_step;f_axis = (0:n_rows)*(Fs)/(seg_size);  axes('Position',[.11,.95,axwidth,1],...                'Units','normalized',...                'Visible','off');            text('Position',[.5,0],...                  'Units','normalized',...                  'FontSize',[16],...                  'HorizontalAlignment','center',...                  'VerticalAlignment','bottom',...                  'String','MVDR Beamforming: BEARING - VS - FREQUENCY GRAM');              %-Bearing gram 2D plotaxbottom = .15;axheight = .79;ax1 = axes('Position',[.11,axbottom,axwidth,axheight],...           'Units','normalized',...           'FontSize',[14],...           'Box','on',...           'TickDir','out',...           'NextPlot','add',...           'XGrid','off',...           'XLim',[0,bmax],...           'YLim',[0,fmax]);if selection == 0    colormap(gray(256));else    map = hsv(329);    colormap(map(256:-1:1,:));endset(ax1,'FontSize',[10])xlabel('Bearing (degrees)')ylabel('Frequency (Hz)')imagesc(b_axis,f_axis,log_gram)%-Color bar legend on left bottomax5 = axes('Position',[.02,.07,.15,.03],...           'Units','normalized',...           'Box','on',...           'NextPlot','add',...           'FontSize',[10],...           'YLim',[1,2],...           'TickDir','out',...           'YTickLabelMode','manual',...           'YTickLabel',[],...           'XLim',[-dB_bottom,-dB_top]);vec = (-dB_bottom:-dB_top)';barr = [vec vec]';imagesc((-dB_bottom:-dB_top),(1:2),barr)xlabel('dB colormap')