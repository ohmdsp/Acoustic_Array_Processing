function plot_CBF_linear_normgram(cbf,Fs,angle_step,seg_size)%% cbf       a two-dimensional array of Energy values from a Array_BTR.m %           script, arranged by time bins vs bearing values % Fs        Sampling rate in samples per second (Hz)% seg_size% overlap   the overlap between analysis center times, in number of%           samples (use same value as entered in the         %==========================================================================%-Compute magnitude and log for gramsep = 1.0e-16;gram = cbf;[n_rows,n_cols]=size(gram);for r = 1:n_rows    linear_cbf(r,:) = cbf(r,:)./max(cbf(r,:)) + ep;endlinear_gram = linear_cbf;selection = input('Enter 0 for gray scale, 1 for color scale: ');figure('PaperOrientation','portrait',...              'PaperPosition',[1.1,1,6.5,9],...              'Position',[10,10,820,620],...              'Units','pixel');   bmax = 360;                     % max bearing in degreesfmax = 1000;                    % max frequency in Hzaxwidth = .78;b_axis = (0:n_cols)*angle_step;f_axis = (0:n_rows)*(Fs)/(seg_size);axes('Position',[.11,.95,axwidth,1],...                'Units','normalized',...                'Visible','off');            text('Position',[.5,0],...                  'Units','normalized',...                  'FontSize',[16],...                  'HorizontalAlignment','center',...                  'VerticalAlignment','bottom',...                  'String','NORMALIZED LINEAR BEARING - VS - FREQ GRAM');              % Time-vs-frequency gram plotaxbottom = .15;axheight = .79;ax1 = axes('Position',[.11,axbottom,axwidth,axheight],...           'Units','normalized',...           'FontSize',[14],...           'Box','on',...           'TickDir','out',...           'NextPlot','add',...           'XGrid','off',...           'XLim',[0,bmax],...           'YLim',[0,fmax]);if selection == 0    colormap(gray(256));else    map = hsv(329);    colormap(map(256:-1:1,:));endset(ax1,'FontSize',[10])xlabel('Bearing (degrees)')ylabel('Center Time of Analysis Window  (sec)')imagesc(b_axis,f_axis,linear_gram)%-Color bar legend on left bottomax5 = axes('Position',[.02,.07,.15,.03],...           'Units','normalized',...           'Box','on',...           'NextPlot','add',...           'FontSize',[10],...           'YLim',[1,2],...           'TickDir','out',...           'YTickLabelMode','manual',...           'YTickLabel',[],...           'XLim',[0,1]);vec = (0:.1:1)';barr = [vec vec]';imagesc((0:.1:1),(1:.1:2),barr)xlabel('dB colormap')